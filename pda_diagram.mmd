graph TD
    %% Main States
    q0((Start))
    q1((Exp Num))
    q2((Exp White))
    q3((Exp Black))
    q4((Game Over))
    qF(((Accept)))

    %% Main Loop
    q0 -- "ε, push z" --> q1
    q1 -- "Move Number (n+1), push ε" --> q2
    q2 -- "Move, push ε" --> q3
    q3 -- "Move, push ε" --> q1

    %% Game End
    q1 -- "Result, push ε" --> q4
    q3 -- "Result, push ε" --> q4

    %% Accept State
    q4 -- "ε, pop z" --> qF

    %% Variation Push/Pop Implementation
    q3 -- "(, push v1" --> q2
    q3 -- "), pop v1" --> q3
    q1 -- "), pop v1" --> q3

    q1 -- "(, push v2" --> q3
    q1 -- "), pop v2" --> q1
    q3 -- "), pop v2" --> q1

    style q0 fill:#f9f,stroke:#333,stroke-width:4px
    style q1 fill:#bbf,stroke:#333,stroke-width:4px
    style q2 fill:#bbf,stroke:#333,stroke-width:4px
    style q3 fill:#bbf,stroke:#333,stroke-width:4px
    style qF fill:#ff9,stroke:#333,stroke-width:4px